<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">ApiBoot新特性GlobalLogging详解 | ApiBoot</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://apiboot2.minbox.org/blog/apiboot-logging-use-global-log"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="ApiBoot新特性GlobalLogging详解 | ApiBoot"><meta data-rh="true" name="description" content="全局日志是一个什么概念呢？"><meta data-rh="true" property="og:description" content="全局日志是一个什么概念呢？"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2019-12-17T10:12:47.000Z"><meta data-rh="true" property="article:author" content="https://github.com/minbox-projects"><meta data-rh="true" property="article:tag" content="Log"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://apiboot2.minbox.org/blog/apiboot-logging-use-global-log"><link data-rh="true" rel="alternate" href="https://apiboot2.minbox.org/blog/apiboot-logging-use-global-log" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://apiboot2.minbox.org/blog/apiboot-logging-use-global-log" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="ApiBoot RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="ApiBoot Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-149679255-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><link rel="stylesheet" href="/assets/css/styles.e0d55a48.css">
<link rel="preload" href="/assets/js/runtime~main.af984a96.js" as="script">
<link rel="preload" href="/assets/js/main.db286dc3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/apiboot-colorful.png" alt="ApiBoot" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/apiboot-colorful.png" alt="ApiBoot" class="themedImage_ToTc themedImage--dark_i4oU"></div></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/out-box/quick-start">使用文档</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">文章教程</a><a href="https://blog.minbox.org" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">作者博客<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/minbox-projects/api-boot" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/apiboot-quartz-job-storage-away">分布式任务调度框架ApiBoot Quartz内的两种任务存储方式</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/apiboot-oauth-multiple-client-config">OAuth2在内存、Redis方式下的多客户端配置</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/apiboot-quartz-job-types">Quartz衍生出的三种任务类型，你用过几个？</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/apiboot-quartz-integrated-away">这种方式整合Quartz你见过吗？</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/apiboot-swagger-integrated-oauth">Swagger2怎么整合OAuth2来在线调试接口？</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">ApiBoot新特性GlobalLogging详解</h1><div class="container_mt6G margin-vert--md"><time datetime="2019-12-17T10:12:47.000Z" itemprop="datePublished">2019年12月17日</time> · <!-- -->阅读需 10 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/minbox-projects" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://blog.minbox.org/images/avatar.png" alt="恒宇少年"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/minbox-projects" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">恒宇少年</span></a></div><small class="avatar__subtitle" itemprop="description">ApiBoot作者，minbox-projects开源组织负责人</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="全局日志是一个什么概念呢">全局日志是一个什么概念呢？<a class="hash-link" href="#全局日志是一个什么概念呢" title="标题的直接链接">​</a></h2><p>其实理解起来比较简单，类似于我们平时一直在使用的<code>logback</code>、<code>log4j</code>这种的日志框架的其中一个功能部分，<code>minbox-logging</code>分布式日志框架目前独立于<code>api-boot-plugins</code>，已经加入了<code>minbox-projects</code>开源组织，之前博客有一系列的文章来讲解了<code>ApiBoot Logging</code>（内部是集成的<code>minbox-logging</code>）日志组件的使用以及极简的配置方式，可以访问<a href="https://blog.yuqiyu.com/apiboot-all-articles.html" target="_blank" rel="noopener noreferrer">ApiBoot 组件系列文章使用汇总</a>了解日志组件的使用详情。</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="什么是全局日志">什么是全局日志？<a class="hash-link" href="#什么是全局日志" title="标题的直接链接">​</a></h2><p>在之前<code>ApiBoot Logging</code>分布式日志组件可以实现<code>日志采集</code>、<code>日志上报</code>、<code>日志统一存储</code>、<code>集成Spring Security</code>、<code>集成Openfeign</code>等功能，随着<code>ApiBoot Logging 2.2.1.RELEASE</code>版本的发布引入了一个新的概念，那就是<code>GlobalLog</code>。</p><p>用过<code>ApiBoot Logging</code>日志组件的同学应该都有了解，它只会记录每一次发送<code>请求</code>相关的一些信息，如：请求参数、请求地址、请求头信息、响应内容等，并没有提供业务代码中的<code>debug</code>、<code>info</code>、<code>error</code>等级日志的采集方式，就不要提上报这种日志到<code>Logging Admin</code>了。</p><p>新版本的发布给我们带来了春天，<code>ApiBoot Logging</code>为了方便代码的调试，执行时业务数据的监控，支持了采集业务代码内的不同等级的日志，而且还支持采集<code>Exception</code>的堆栈信息，方便定位错误，及时纠正。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="了解globallogging接口">了解GlobalLogging接口<a class="hash-link" href="#了解globallogging接口" title="标题的直接链接">​</a></h2><p>为了支持<code>业务全局日志</code>，新版本中引入了<code>GlobalLogging</code>接口，我们先来看看这个接口的源码，如下所示：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999"> * Global log collection interface</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999"> * Provide debug, info, and error log collection</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999"> *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999"> * @author 恒宇少年</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">interface</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">GlobalLogging</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * Collect Debug Level Logs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @param msg log content</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">void</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">debug</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * Collect Debug Level Logs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @param format    Unformatted log content</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @param arguments List of parameters corresponding to log content</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">void</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">debug</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> format</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Object</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain"> arguments</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * Collect Info Level Logs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @param msg log content</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">void</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">info</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * Collect Info Level Logs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @param format    Unformatted log content</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @param arguments List of parameters corresponding to log content</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">void</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">info</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> format</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Object</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain"> arguments</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * Collect Error Level Logs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @param msg log content</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">void</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * Collect Error Level Logs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @param msg       log content</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @param throwable Exception object instance</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">void</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Throwable</span><span class="token plain"> throwable</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * Collect Error Level Logs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @param format    Unformatted log content</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @param arguments List of parameters corresponding to log content</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">void</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> format</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Object</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain"> arguments</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在<code>GlobalLogging</code>接口内提供了三种类型的日志采集方法，分别是：<code>debug</code>、<code>info</code>、<code>error</code>，这个版本只是对日志的等级进行了划分，并没有添加限制或者过滤机制。</p><p><code>GlobalLogging</code>当前版本有一个实现类<code>org.minbox.framework.logging.client.global.support.GlobalLoggingMemoryStorage</code>，该类实现了<code>GlobalLogging</code>内的全部方法，并将采集到的日志保存到了<code>GlobalLoggingThreadLocal</code>，方便统一上报到<code>Logging Admin</code>。</p><p>为了方便后期修改<code>Global Log</code>的存储方式，<code>ApiBoot Logging</code>提供了一个配置参数<code>api.boot.logging.global-logging-storage-away</code>，该配置的默认值为<code>memory</code>，对应<code>GlobalLoggingMemoryStorage</code>实现类。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="globallogging自动化配置">GlobalLogging自动化配置<a class="hash-link" href="#globallogging自动化配置" title="标题的直接链接">​</a></h2><p><code>ApiBoot Logging</code>根据<code>api.boot.logging.global-logging-storage-away</code>配置参数，条件判断自动化配置了<code>GlobalLogging</code>接口的实现类，如下所示：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">org</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">minbox</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">framework</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">api</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">boot</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">autoconfigure</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">logging</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999"> * the &quot;minbox-logging&quot; global log storage configuration</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999"> *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999"> * @author 恒宇少年</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token annotation punctuation" style="color:#8dc891">@Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token annotation punctuation" style="color:#8dc891">@ConditionalOnClass</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">GlobalLogging</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">ApiBootLoggingGlobalLogStorageAutoConfiguration</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * Instance global log memory mode storage</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @return {@link GlobalLoggingMemoryStorage}</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#8dc891">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#8dc891">@ConditionalOnProperty</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">prefix </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token constant" style="color:#5a9bcf">API_BOOT_LOGGING_PREFIX</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        name </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;global-logging-storage-away&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> havingValue </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;memory&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> matchIfMissing </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">true</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">GlobalLogging</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">globalLogging</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">new</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">GlobalLoggingMemoryStorage</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>根据<code>globalLogging()</code>方法上的条件注入注解<code>@ConditionalOnProperty</code>配置内容可以了解到，当我们在<code>application.yml</code>配置文件内添加<code>api.boot.logging.global-logging-storage-away=memory</code>时或者<code>缺少该配置</code>时，该方法会被调用并且创建一个<code>GlobalLoggingMemoryStorage</code>对象实例，并将该实例对象写入到<code>IOC</code>容器内，这样我们在使用<code>GlobalLogging</code>实例时，只需要注入就可以了，如下所示：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">  * {@link GlobalLogging}</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">  *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">  * @see org.minbox.framework.logging.client.global.AbstractGlobalLogging</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">  * @see org.minbox.framework.logging.client.global.support.GlobalLoggingMemoryStorage</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">  */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token annotation punctuation" style="color:#8dc891">@Autowired</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">GlobalLogging</span><span class="token plain"> logging</span><span class="token punctuation" style="color:#8dc891">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="使用globallogging">使用GlobalLogging<a class="hash-link" href="#使用globallogging" title="标题的直接链接">​</a></h2><p>采集的方式很简单，我们只需要注入<code>GlobalLogging</code>对象，使用该接口提供的方法即可，如下所示：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999"> * 测试用户控制器</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999"> *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999"> * @author 恒宇少年</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token annotation punctuation" style="color:#8dc891">@RestController</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token annotation punctuation" style="color:#8dc891">@RequestMapping</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">value </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;/user&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">UserController</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * {@link GlobalLogging}</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @see org.minbox.framework.logging.client.global.AbstractGlobalLogging</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @see org.minbox.framework.logging.client.global.support.GlobalLoggingMemoryStorage</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#8dc891">@Autowired</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">GlobalLogging</span><span class="token plain"> logging</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * 测试获取用户名</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     *</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     * @return</span><br></span><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#8dc891">@GetMapping</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">value </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;/name&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">getUserName</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        logging</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">debug</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;这是一条debug级别的日志&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        logging</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">info</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;这是一条info级别的日志&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;用户名：恒宇少年&quot;</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当我们调用<code>GlobalLogging</code>提供的不同日志等级的方法时，会自动将日志相关信息写入到<code>GlobalLoggingThreadLocal</code>的集合内，等到上报请求日志时一并提交给<code>Logging Admin</code>，由<code>Logging Admin</code>进行保存。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="globallogging表结构">GlobalLogging表结构<a class="hash-link" href="#globallogging表结构" title="标题的直接链接">​</a></h2><p><code>GlobalLogging</code>相关的全局日志采集到<code>Logging Admin</code>需要进行保存，所有对应添加了一个名为<code>logging_global_logs</code>信息表，结构如下所示：</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">logging_global_logs</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">lgl_id</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">varchar</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">36</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COLLATE</span><span class="token plain"> utf8mb4_general_ci </span><span class="token operator" style="color:#d7deea">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;日志主键&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">lgl_request_log_id</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">varchar</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">36</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COLLATE</span><span class="token plain"> utf8mb4_general_ci </span><span class="token operator" style="color:#d7deea">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;请求日志编号，关联logging_request_logs主键&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">lgl_level</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">varchar</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">20</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COLLATE</span><span class="token plain"> utf8mb4_general_ci </span><span class="token keyword" style="color:#c5a5c5">DEFAULT</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;日志等级&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">lgl_content</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">mediumtext</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COLLATE</span><span class="token plain"> utf8mb4_general_ci </span><span class="token keyword" style="color:#c5a5c5">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;日志内容&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">lgl_caller_class</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">varchar</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">200</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COLLATE</span><span class="token plain"> utf8mb4_general_ci </span><span class="token keyword" style="color:#c5a5c5">DEFAULT</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;日志输出的类名&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">lgl_caller_method</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">varchar</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">50</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COLLATE</span><span class="token plain"> utf8mb4_general_ci </span><span class="token keyword" style="color:#c5a5c5">DEFAULT</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;日志输出的方法名称&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">lgl_caller_code_line_number</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">int</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">11</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">DEFAULT</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;日志输出的代码行号&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">lgl_exception_stack</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">mediumtext</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COLLATE</span><span class="token plain"> utf8mb4_general_ci </span><span class="token keyword" style="color:#c5a5c5">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;error等级的日志异常堆栈信息&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">lgl_create_time</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">mediumtext</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">COLLATE</span><span class="token plain"> utf8mb4_general_ci </span><span class="token keyword" style="color:#c5a5c5">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;日志发生时间&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">KEY</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">lgl_id</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">KEY</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">logging_global_logs_logging_request_logs_lrl_id_fk</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">lgl_request_log_id</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">CONSTRAINT</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">logging_global_logs_logging_request_logs_lrl_id_fk</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">FOREIGN</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">KEY</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">lgl_request_log_id</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">REFERENCES</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">logging_request_logs</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token identifier">lrl_id</span><span class="token identifier punctuation" style="color:#8dc891">`</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">ENGINE</span><span class="token operator" style="color:#d7deea">=</span><span class="token keyword" style="color:#c5a5c5">InnoDB</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">DEFAULT</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">CHARSET</span><span class="token operator" style="color:#d7deea">=</span><span class="token plain">utf8mb4 </span><span class="token keyword" style="color:#c5a5c5">COLLATE</span><span class="token operator" style="color:#d7deea">=</span><span class="token plain">utf8mb4_general_ci </span><span class="token keyword" style="color:#c5a5c5">COMMENT</span><span class="token operator" style="color:#d7deea">=</span><span class="token string" style="color:#8dc891">&#x27;全局日志信息表&#x27;</span><span class="token punctuation" style="color:#8dc891">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="采集exception堆栈信息">采集Exception堆栈信息<a class="hash-link" href="#采集exception堆栈信息" title="标题的直接链接">​</a></h2><p>使用<code>GlobalLogging</code>可以采集遇到异常的详细堆栈信息，可以让我们直接定位到问题出现的位置，在第一时间解决出现的问题，具体使用如下所示：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">int</span><span class="token plain"> a </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">5</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">/</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  logging</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">getMessage</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="运行测试">运行测试<a class="hash-link" href="#运行测试" title="标题的直接链接">​</a></h2><p>我们来运行本章的源码，看下日志采集的效果。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="输出的采集日志">输出的采集日志<a class="hash-link" href="#输出的采集日志" title="标题的直接链接">​</a></h3><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;endTime&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token number" style="color:#5a9bcf">1576561372604</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;globalLogs&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;callerClass&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;org.minbox.chapter.user.service.UserController&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;callerCodeLineNumber&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token number" style="color:#5a9bcf">33</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;callerMethod&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;getUserName&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;content&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;这是一条debug级别的日志，发生时间：{}&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;createTime&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token number" style="color:#5a9bcf">1576561372585</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;level&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;debug&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;callerClass&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;org.minbox.chapter.user.service.UserController&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;callerCodeLineNumber&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token number" style="color:#5a9bcf">34</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;callerMethod&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;getUserName&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;content&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;这是一条info级别的日志，发生时间：1576561372586&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;createTime&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token number" style="color:#5a9bcf">1576561372586</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;level&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;info&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;callerClass&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;org.minbox.chapter.user.service.UserController&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;callerCodeLineNumber&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token number" style="color:#5a9bcf">43</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;callerMethod&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;aa&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;content&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;出现了异常.&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;createTime&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token number" style="color:#5a9bcf">1576561372586</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;exceptionStack&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;java.lang.ArithmeticException: / by zero\n\tat org.minbox.chapter.user.service.UserController.aa(UserController.java:41)\n\tat org.minbox.chapter.user.service.UserController.getUserName(UserController.java:35)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\t....&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;level&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;error&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;httpStatus&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token number" style="color:#5a9bcf">200</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;requestBody&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;requestHeaders&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;accept&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;*/*&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;host&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;localhost:10000&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;user-agent&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;curl/7.64.1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;requestIp&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;0:0:0:0:0:0:0:1&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;requestMethod&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;GET&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;requestParam&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;{}&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;requestUri&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;/user/name&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;responseBody&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;用户名：恒宇少年&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;responseHeaders&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;serviceId&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;user-service&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;serviceIp&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;127.0.0.1&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;servicePort&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;10000&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;spanId&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;41a0c852-812b-4a2e-aa4a-228b87ce52f6&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;startTime&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token number" style="color:#5a9bcf">1576561372577</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;timeConsuming&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token number" style="color:#5a9bcf">27</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;traceId&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token string" style="color:#8dc891">&quot;42ca9f5a-5977-49cf-909d-a23614a47a6b&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>上面是控制台输出的一个请求日志的详细内容，其中<code>globalLogs</code>字段就是我们采集的全局日志列表。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="存储的采集日志">存储的采集日志<a class="hash-link" href="#存储的采集日志" title="标题的直接链接">​</a></h3><p>我们来确认下采集日志上报到<code>Logging Admin</code>后是否保存到了<code>logging_global_logs</code>日志表内，如下所示：</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">mysql</span><span class="token operator" style="color:#d7deea">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">select</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">from</span><span class="token plain"> logging_global_logs </span><span class="token keyword" style="color:#c5a5c5">order</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">by</span><span class="token plain"> lgl_create_time </span><span class="token keyword" style="color:#c5a5c5">asc</span><span class="token plain">\G</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1.</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">row</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                     lgl_id: </span><span class="token number" style="color:#5a9bcf">112</span><span class="token plain">e36ff</span><span class="token operator" style="color:#d7deea">-</span><span class="token plain">e781</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">4</span><span class="token plain">f11</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">8</span><span class="token plain">f21</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">2196823</span><span class="token plain">cde38</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">         lgl_request_log_id: f91382e2</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">2</span><span class="token plain">d79</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">499</span><span class="token plain">e</span><span class="token operator" style="color:#d7deea">-</span><span class="token plain">b1df</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">4757</span><span class="token plain">c1ffdbc5</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  lgl_level: info</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                lgl_content: 这是一条info级别的日志，发生时间：</span><span class="token number" style="color:#5a9bcf">1576561856333</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">           lgl_caller_class: org</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">minbox</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">chapter</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token keyword" style="color:#c5a5c5">user</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">service</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">UserController</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          lgl_caller_method: getUserName</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">lgl_caller_code_line_number: </span><span class="token number" style="color:#5a9bcf">34</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        lgl_exception_stack: </span><span class="token boolean" style="color:#ff8b50">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            lgl_create_time: </span><span class="token number" style="color:#5a9bcf">1576561856333</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">2.</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">row</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                     lgl_id: f1d172a6</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">5</span><span class="token plain">cce</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">4</span><span class="token plain">df0</span><span class="token operator" style="color:#d7deea">-</span><span class="token plain">bc29</span><span class="token operator" style="color:#d7deea">-</span><span class="token plain">fe27ac441089</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">         lgl_request_log_id: f91382e2</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">2</span><span class="token plain">d79</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">499</span><span class="token plain">e</span><span class="token operator" style="color:#d7deea">-</span><span class="token plain">b1df</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">4757</span><span class="token plain">c1ffdbc5</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  lgl_level: debug</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                lgl_content: 这是一条debug级别的日志，发生时间：{}</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">           lgl_caller_class: org</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">minbox</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">chapter</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token keyword" style="color:#c5a5c5">user</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">service</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">UserController</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          lgl_caller_method: getUserName</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">lgl_caller_code_line_number: </span><span class="token number" style="color:#5a9bcf">33</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        lgl_exception_stack: </span><span class="token boolean" style="color:#ff8b50">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            lgl_create_time: </span><span class="token number" style="color:#5a9bcf">1576561856333</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">3.</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">row</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token operator" style="color:#d7deea">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                     lgl_id: d95d850d</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">3</span><span class="token plain">bc9</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">4689</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">928</span><span class="token plain">a</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">32</span><span class="token plain">c6089ff7a2</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">         lgl_request_log_id: f91382e2</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">2</span><span class="token plain">d79</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">499</span><span class="token plain">e</span><span class="token operator" style="color:#d7deea">-</span><span class="token plain">b1df</span><span class="token operator" style="color:#d7deea">-</span><span class="token number" style="color:#5a9bcf">4757</span><span class="token plain">c1ffdbc5</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  lgl_level: error</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                lgl_content: 出现了异常</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">           lgl_caller_class: org</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">minbox</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">chapter</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token keyword" style="color:#c5a5c5">user</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">service</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">UserController</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          lgl_caller_method: getUserName</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">lgl_caller_code_line_number: </span><span class="token number" style="color:#5a9bcf">38</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        lgl_exception_stack: java</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">lang</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ArithmeticException: </span><span class="token operator" style="color:#d7deea">/</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">by</span><span class="token plain"> zero</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        at org</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">minbox</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">chapter</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token keyword" style="color:#c5a5c5">user</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">service</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">UserController</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">getUserName</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">UserController</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">java:</span><span class="token number" style="color:#5a9bcf">36</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        at sun</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">reflect</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">NativeMethodAccessorImpl</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">invoke0</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">Native Method</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        at sun</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">reflect</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">NativeMethodAccessorImpl</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">invoke</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">NativeMethodAccessorImpl</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">java:</span><span class="token number" style="color:#5a9bcf">62</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                        </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            lgl_create_time: </span><span class="token number" style="color:#5a9bcf">1576561856334</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token number" style="color:#5a9bcf">3</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">rows</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">in</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">set</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">0.01</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>这里异常的堆栈信息比较多，做出了省略。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="敲黑板划重点">敲黑板，划重点<a class="hash-link" href="#敲黑板划重点" title="标题的直接链接">​</a></h2><p>本章把<code>GlobalLog</code>全局日志的概念进行了详细的描述，建议将一些重要逻辑判断性质的<code>GlobalLog</code>进行采集上报，防止<code>logging_global_logs</code>表内的数据量过大。</p><blockquote><p>详细的使用方式请参考本章的源码。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="代码示例">代码示例<a class="hash-link" href="#代码示例" title="标题的直接链接">​</a></h2><p>如果您喜欢本篇文章请为源码仓库点个<code>Star</code>，谢谢！！！
本篇文章示例源码可以通过以下途径获取，目录为<code>apiboot-logging-use-global-log</code>：</p><ul><li>Gitee：<a href="https://gitee.com/minbox-projects/api-boot-chapter" target="_blank" rel="noopener noreferrer">https://gitee.com/minbox-projects/api-boot-chapter</a></li></ul></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/log">Log</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/apiboot-swagger-describe-the-interface"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">使用Swagger2作为文档来描述你的接口信息</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/apiboot-oauth-use-redis-storage"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">OAuth2使用Redis来存储客户端信息以及AccessToken</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#全局日志是一个什么概念呢" class="table-of-contents__link toc-highlight">全局日志是一个什么概念呢？</a></li><li><a href="#什么是全局日志" class="table-of-contents__link toc-highlight">什么是全局日志？</a></li><li><a href="#了解globallogging接口" class="table-of-contents__link toc-highlight">了解GlobalLogging接口</a></li><li><a href="#globallogging自动化配置" class="table-of-contents__link toc-highlight">GlobalLogging自动化配置</a></li><li><a href="#使用globallogging" class="table-of-contents__link toc-highlight">使用GlobalLogging</a></li><li><a href="#globallogging表结构" class="table-of-contents__link toc-highlight">GlobalLogging表结构</a></li><li><a href="#采集exception堆栈信息" class="table-of-contents__link toc-highlight">采集Exception堆栈信息</a></li><li><a href="#运行测试" class="table-of-contents__link toc-highlight">运行测试</a><ul><li><a href="#输出的采集日志" class="table-of-contents__link toc-highlight">输出的采集日志</a></li><li><a href="#存储的采集日志" class="table-of-contents__link toc-highlight">存储的采集日志</a></li></ul></li><li><a href="#敲黑板划重点" class="table-of-contents__link toc-highlight">敲黑板，划重点</a></li><li><a href="#代码示例" class="table-of-contents__link toc-highlight">代码示例</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档 &amp; 教程</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/out-box/quick-start">使用文档</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">文章教程</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/introduce/faq">问题反馈</a></li></ul></div><div class="col footer__col"><div class="footer__title">资源</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blog.minbox.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">作者博客<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/minbox-projects/api-boot" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 ApiBoot, Inc. 恒宇少年.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.af984a96.js"></script>
<script src="/assets/js/main.db286dc3.js"></script>
</body>
</html>